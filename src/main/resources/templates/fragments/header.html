<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
</head>
<body>
    <header th:fragment="header" class="header">
        <div class="container header-container">
            <div class="header-main">
                <div class="header-left">
                    <!-- Botón de menú solo para usuarios logueados -->
                    <a th:href="@{/}" class="logo">
                        <img th:src="@{/img/index/logohm.jpg}" alt="Logo" class="logo-img">
                    </a>
                </div>
                
                <div class="search-container">
                    <div class="country-selector">
                        <i class="fas fa-map-marker-alt"></i>
                        <div class="custom-select" id="countrySelect">
                            <div class="select-trigger" id="selectTrigger">
                                <img src="https://flagcdn.com/ec.svg" alt="Ecuador" class="flag-icon">
                                <span>Ecuador</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="select-options" id="selectOptions">
                                <div class="select-option" data-value="EC" data-flag="ec">
                                    <img src="https://flagcdn.com/ec.svg" alt="Ecuador" class="flag-icon">
                                    <span>Ecuador</span>
                                </div>
                                <div class="select-option" data-value="AR" data-flag="ar">
                                    <img src="https://flagcdn.com/ar.svg" alt="Argentina" class="flag-icon">
                                    <span>Argentina</span>
                                </div>
                                <div class="select-option" data-value="BO" data-flag="bo">
                                    <img src="https://flagcdn.com/bo.svg" alt="Bolivia" class="flag-icon">
                                    <span>Bolivia</span>
                                </div>
                                <div class="select-option" data-value="BR" data-flag="br">
                                    <img src="https://flagcdn.com/br.svg" alt="Brasil" class="flag-icon">
                                    <span>Brasil</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="search-bar">
                        <input type="text" id="searchInput" placeholder="Buscar productos..." autocomplete="off">
                        <button id="searchButton">
                            <i class="fas fa-search"></i>
                        </button>
                    </div>
                    <!-- Modal de búsqueda -->
                    <div id="searchModal" class="search-modal">
                        <div class="search-modal-content">
                            <div class="search-modal-header">
                                <h3>Resultados de búsqueda</h3>
                                <button id="closeSearchModal" class="close-modal">&times;</button>
                            </div>
                            <div class="search-modal-body">
                                <div id="searchLoading" class="search-loading">
                                    <i class="fas fa-spinner fa-spin"></i>
                                    <p>Buscando productos...</p>
                                </div>
                                <div id="searchResults" class="search-results"></div>
                                <div id="noResults" class="no-results" style="display: none;">
                                    <i class="fas fa-search"></i>
                                    <p>No se encontraron productos que coincidan con tu búsqueda.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="header-actions">
                    <!-- Usuario logueado -->
                    <div th:if="${session.nombreUsuario}" class="user-info">
                        <a th:href="@{/user}" class="user-icon">
                            <i class="fas fa-user-circle"></i>
                            <span th:text="${session.nombreUsuario}">Usuario</span>
                        </a>
                    </div>
                    <!-- Usuario no logueado -->
                    <a th:unless="${session.nombreUsuario}" th:href="@{/auth/login}" class="user-icon">
                        <i class="fas fa-user-circle"></i>
                        <span>Iniciar sesión</span>
                    </a>
                    
                    <!-- Reemplazar el botón del carrito actual con: -->
                    <a th:href="@{/carrito}" class="cart-button" id="cartButton">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-count" id="cartCount">0</span>
                    </a>
                </div>
            </div>

            <!-- Navegación principal -->
            <nav class="main-nav">
                <a th:href="@{/explorar}">Explorar</a>
                <a href="#">Electrónicos</a>
                <a href="#">Casa y Jardín</a>
                <a href="#">Juguetes</a>
                <a href="#">Ropa</a>
            </nav>
        </div>
        <!-- Mover el script dentro del fragmento -->
        <script type="text/javascript" th:src="@{/js/common/header.js}"></script>
        <script th:src="@{/js/search/search.js}"></script>
    </header>
</body>
</html>